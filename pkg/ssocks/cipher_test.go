package ssocks

import (
	"bytes"
	"testing"
)

func TestEvpBytesToKey(t *testing.T) {
	key := evpBytesToKey([]byte("foobar"), 32)
	expectedKey := []byte{0x38, 0x58, 0xf6, 0x22, 0x30, 0xac, 0x3c, 0x91, 0x5f, 0x30, 0x0c, 0x66, 0x43, 0x12, 0xc6, 0x3f, 0x56, 0x83, 0x78, 0x52, 0x96, 0x14, 0xd2, 0x2d, 0xdb, 0x49, 0x23, 0x7d, 0x2f, 0x60, 0xbf, 0xdf}
	if !bytes.Equal(key, expectedKey) {
		t.Errorf("key(%s) != expectedKey(%s)", key, expectedKey)
	}
}
